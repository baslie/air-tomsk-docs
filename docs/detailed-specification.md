# Детальное техническое задание
## Сайт АНО «Агентство инвестиционного развития Томской области»

---

## Оглавление

1. [Сводка по объёму работ](#1-сводка-по-объёму-работ)
2. [Структура страниц и шаблонов](#2-структура-страниц-и-шаблонов)
3. [Сводная таблица страниц](#3-сводная-таблица-страниц)
4. [Функциональные модули](#4-функциональные-модули)
5. [Технические требования](#5-технические-требования)
6. [Рекомендуемый стек технологий](#6-рекомендуемый-стек-технологий)
7. [Рекомендация по стеку](#7-рекомендация-по-стеку)
8. [Оценка трудозатрат](#8-оценка-трудозатрат-ориентировочно)
9. [Уточнённые требования](#9-уточнённые-требования)
10. [Влияние многоязычности на объём работ](#10-влияние-многоязычности-на-объём-работ)
11. [Открытые вопросы](#11-открытые-вопросы)
12. [Frontend-стек](#12-frontend-стек)

---

## 1. Сводка по объёму работ

| Показатель | Значение |
|------------|----------|
| **Всего уникальных шаблонов страниц** | 8 |
| **Всего страниц контента** | ~25-30 |
| **Формы** | 3 |
| **Интеграции** | 2-3 |

---

## 2. Структура страниц и шаблонов

### 2.1. Главная страница
**Шаблон:** `home`

| Элемент | Описание | Сложность |
|---------|----------|-----------|
| Шапка сайта | Логотип, герб ТО, телефон, поиск | Средняя |
| Вертикальное меню | 6 пунктов, фиксированное слева | Средняя |
| Hero-блок | Слоган + фоновое фото области | Низкая |
| Приветствие | Фото + текст вице-губернатора | Низкая |
| Форма обратной связи | С загрузкой файлов (.doc, .pdf, .jpeg) | Высокая |
| Баннеры | 4 кликабельных баннера (внешние ссылки) | Низкая |
| Подвал | Контакты, копирайт | Низкая |

**Функционал:**
- Поиск по сайту (полнотекстовый)
- Форма с валидацией и загрузкой файлов
- Адаптивная вёрстка

---

### 2.2. Раздел «О регионе»
**Шаблон:** `region` (с боковым подменю)

| Страница | Контент | Примечание |
|----------|---------|------------|
| Томская область для инвесторов | Текст + изображения | Главная страница раздела |
| О сильных сторонах региона | Текст + инфографика | Подстраница |
| О ведущих отраслях | Текст + иконки/графики | Подстраница |
| Точки роста | Текст + карта/схема | Подстраница |
| О томских купцах | Историческая справка | Подстраница |

**Дополнительно:**
- Блок «Значимые инвестпроекты» — карточки (фото + описание)
- Количество подстраниц: **5**

---

### 2.3. Раздел «Инвестору»
**Шаблон:** `investor` (с боковым подменю)

#### Главная страница раздела:
| Элемент | Описание |
|---------|----------|
| Центр развития бизнеса | Описание услуг, преимущества |
| Инфографика «Путь инвестора» | Интерактивная схема этапов |
| Пакет документов | Список файлов для скачивания |

#### Подразделы:

**А) Инфраструктура поддержки** — 9 карточек организаций:
1. Департамент инвестиционной и промышленной политики ТО
2. АИР ТО (+ учредительные документы)
3. Центр «Мой бизнес»
4. Центр поддержки экспорта
5. Фонд развития промышленности ТО
6. Фонд микрофинансирования ТО
7. ОЭЗ ТВТ «Томск»
8. Промышленный парк «Томск»
9. ТОР «Северск»

Каждая карточка: фото руководителя, ФИО, контакты, описание, ссылка на сайт.

**Б) Перечень мер поддержки** — страница-каталог мер

**В) Инвестиционные предложения муниципалитетов** — карточки/презентации

**Количество страниц в разделе: 12** (1 главная + 9 организаций + 2 каталога)

---

### 2.4. Раздел «Новости»
**Шаблоны:** `news-list` + `news-detail`

| Компонент | Описание |
|-----------|----------|
| Лента новостей | Сетка 6 новостей, пагинация |
| Детальная страница | Заголовок, дата, текст, изображения |
| Кнопка «Подробнее» | Переход на детальную страницу |

**Функционал:**
- Пагинация
- Фильтрация по дате (опционально)
- SEO-friendly URL

---

### 2.5. Раздел «Регинвестстандарт»
**Шаблон:** `standard` (с боковым подменю)

Согласно Приказу Минэко № 591:

| Подраздел | Тип контента |
|-----------|--------------|
| Инвестиционная декларация субъекта РФ | Документ/текст |
| Свод инвестправил | Документ/текст |
| Инвест карта субъекта РФ | Интерактивная карта или ссылка |
| Инвест комитет | Состав, документы |
| Реестр инвестпроектов субъекта РФ | Таблица/каталог |
| Лучшие практики | Кейсы, описания |
| Инвестиционная команда ТО | Карточки сотрудников |

**Количество подстраниц: 7**

---

### 2.6. Раздел «Выбирай своё»
**Шаблон:** `brand`

| Элемент | Описание |
|---------|----------|
| Описание проекта | Текстовый блок |
| Контакты для связи | Телефон, email |
| Форма заявки | «Подать заявку на участие» |

---

### 2.7. Раздел «Контакты»
**Шаблон:** `contacts`

| Элемент | Описание |
|---------|----------|
| Команда | Директор, замы, начальники отделов (фото, ФИО, контакты) |
| Карта проезда | Интеграция Яндекс.Карты |
| Форма обратной связи | Аналогичная главной странице |

---

## 3. Сводная таблица страниц

| № | Раздел | Кол-во страниц | Шаблон |
|---|--------|----------------|--------|
| 1 | Главная | 1 | home |
| 2 | О регионе | 5 | region |
| 3 | Инвестору | 12 | investor |
| 4 | Новости | 1 + N (динамические) | news-list, news-detail |
| 5 | Регинвестстандарт | 7 | standard |
| 6 | Выбирай своё | 1 | brand |
| 7 | Контакты | 1 | contacts |
| — | **Итого статических** | **~28** | **8 уникальных шаблонов** |

---

## 4. Функциональные модули

### 4.1. Формы обратной связи
| Поле | Тип | Обязательное |
|------|-----|--------------|
| Тема | select/text | Нет |
| Фамилия | text | Да |
| Имя | text | Да |
| E-mail | email | Да |
| Ваш вопрос | textarea | Нет |
| Вложения | file (multiple) | Нет |

**Требования:**
- Форматы файлов: .doc, .docx, .pdf, .jpeg, .jpg, .png
- Множественная загрузка
- Валидация на клиенте и сервере
- Отправка на email администратора
- Защита от спама (CAPTCHA или honeypot)

### 4.2. Поиск по сайту
- Полнотекстовый поиск по всем страницам
- Подсветка результатов
- Пагинация результатов

### 4.3. Административная панель
| Функция | Описание |
|---------|----------|
| Управление страницами | WYSIWYG-редактор, SEO-поля |
| Управление новостями | Создание, редактирование, удаление |
| Управление файлами | Медиа-библиотека |
| Управление формами | Просмотр заявок |
| Управление меню | Редактирование структуры |
| Управление баннерами | Добавление/удаление ссылок |

### 4.4. Интеграции
| Сервис | Назначение |
|--------|------------|
| Яндекс.Карты | Карта проезда на странице контактов |
| Яндекс.Метрика | Статистика посещений |
| ПОС «Бизнес» | Виджет/ссылка (внешний сервис) |

---

## 5. Технические требования

### 5.1. Кроссбраузерность
- Яндекс.Браузер
- Google Chrome
- Mozilla Firefox
- Microsoft Edge (вместо устаревшего IE)
- Apple Safari
- Opera

### 5.2. Адаптивность
- Desktop (1920px, 1440px, 1280px)
- Tablet (1024px, 768px)
- Mobile (480px, 375px, 320px)

### 5.3. Производительность
- Время загрузки главной страницы < 3 сек
- Оптимизация изображений (WebP с fallback)
- Lazy loading для изображений

### 5.4. SEO
- Семантическая вёрстка (HTML5)
- Meta-теги (title, description, og:*)
- Sitemap.xml
- robots.txt
- ЧПУ (человекопонятные URL)

### 5.5. Безопасность
- HTTPS (SSL-сертификат)
- Защита от XSS, CSRF, SQL-injection
- Валидация загружаемых файлов
- Rate limiting для форм

---

## 6. Рекомендуемый стек технологий

### Вариант 1: Python + Django (рекомендуется)

| Компонент | Технология | Обоснование |
|-----------|------------|-------------|
| **Backend** | Django 5.2 | Встроенная админка, ORM, безопасность |
| **Frontend** | HTML5 + CSS3 + JS | Без тяжёлых фреймворков для простоты |
| **CSS-фреймворк** | Tailwind CSS или Bootstrap 5 | Быстрая адаптивная вёрстка |
| **База данных** | PostgreSQL 16 | Надёжность, поддержка в РФ |
| **Веб-сервер** | Nginx + Gunicorn | Стандарт для Python-приложений |
| **Кэширование** | Redis | Сессии, кэш страниц |
| **Поиск** | Django + PostgreSQL FTS | Полнотекстовый поиск без внешних зависимостей |
| **Хостинг** | Любой VPS в РФ | Selectel, Timeweb, REG.RU |

**Преимущества Django:**
- Мощная встроенная админ-панель (легко настраивается под контент-менеджеров)
- Безопасность «из коробки»
- Большое сообщество в РФ
- Простота поддержки штатными сотрудниками

### Вариант 2: PHP + Laravel 11

| Компонент | Технология |
|-----------|------------|
| **Backend** | Laravel 11 |
| **Админка** | Laravel Nova или Filament |
| **База данных** | PostgreSQL / MySQL |
| **Веб-сервер** | Nginx + PHP-FPM |

**Преимущества:** Широко распространён в РФ, много специалистов.
**Недостаток:** Админку нужно настраивать отдельно (платная Nova или бесплатная Filament).

### Вариант 3: Headless CMS + Next.js

| Компонент | Технология |
|-----------|------------|
| **Backend/CMS** | Strapi или Directus |
| **Frontend** | Next.js 15 (React) |
| **База данных** | PostgreSQL |

**Преимущества:** Современный подход, гибкость.
**Недостаток:** Сложнее для штатных сотрудников, требует Node.js на сервере.

---

## 7. Рекомендация по стеку

Для государственного сервиса на серверах РФ с поддержкой штатными сотрудниками рекомендую:

### **Django 5.2 + PostgreSQL + Tailwind CSS**

**Аргументы:**
1. **Админка** — Django Admin легко кастомизируется и понятна контент-менеджерам без технического образования
2. **Безопасность** — встроенная защита от основных уязвимостей (OWASP Top 10)
3. **Импортозамещение** — Python и PostgreSQL не имеют санкционных ограничений
4. **Хостинг в РФ** — работает на любом Linux VPS (Selectel, Timeweb, Beget, REG.RU)
5. **Документация** — актуальная документация Django 5.2 доступна
6. **Специалисты** — легко найти разработчиков для поддержки

---

## 8. Оценка трудозатрат (ориентировочно)

| Этап | Состав работ |
|------|--------------|
| **Дизайн** | 3 варианта макета, адаптив, UI-kit |
| **Вёрстка** | 8 уникальных шаблонов + компоненты |
| **Backend** | Модели, админка, формы, поиск |
| **Интеграции** | Яндекс.Карты, Метрика, почта |
| **Контент** | Первичное наполнение (по ТЗ — исполнитель) |
| **Тестирование** | Кроссбраузерность, адаптив, формы |
| **Документация** | Руководство администратора, видеоинструкция |
| **Деплой** | Настройка сервера, SSL, домен |

---

## 9. Уточнённые требования

| Вопрос | Решение |
|--------|---------|
| Инвест карта | Требует уточнения у заказчика |
| Реестр инвестпроектов | **Карточки проектов** с фото, описанием, статусом |
| Многоязычность | **Русский + английский** (переключатель языков) |

---

## 10. Влияние многоязычности на объём работ

Добавление английской версии сайта увеличивает трудозатраты:

| Компонент | Дополнительные работы |
|-----------|----------------------|
| **Контент** | Перевод всех текстов (~28 страниц) |
| **Админка** | Интерфейс для управления переводами |
| **Вёрстка** | Адаптация под разную длину текстов |
| **URL-структура** | /ru/... и /en/... или поддомен en.site.ru |
| **SEO** | Hreflang-теги, отдельные meta для каждого языка |
| **Формы** | Локализация валидации и сообщений |

**Рекомендация по реализации:**
- Django: библиотека `django-modeltranslation` или `django-parler`
- Laravel: пакет `spatie/laravel-translatable`

---

## 11. Открытые вопросы

1. **Инвест карта** — вынесена как отдельная опция (см. раздел 13), при необходимости интеграция с OrbisMap
2. **Интеграция с ЕСИА** — нужна ли авторизация через Госуслуги?
3. **Уведомления** — только email или нужны SMS/Telegram?
4. **Переводы** — кто будет предоставлять английские тексты?

---

## 12. Frontend-стек

### 12.1. Обзор технологий

| Технология | Версия | Назначение |
|------------|--------|------------|
| **Tailwind CSS** | 4.x | Utility-first CSS фреймворк |
| **Alpine.js** | 3.x | Лёгкий JS-фреймворк для интерактивности |
| **django-cotton** | — | Компонентный подход к Django templates |
| **shadcn-django** | — | Библиотека UI-компонентов (порт shadcn/ui) |
| **Unfold Admin** | 0.76+ | Современная тема для Django Admin |

### 12.2. Tailwind CSS

**Описание:** Utility-first CSS фреймворк для быстрой вёрстки без написания кастомного CSS.

**Преимущества для проекта:**
- Быстрая адаптивная вёрстка (mobile-first)
- Встроенная поддержка тёмной темы
- JIT-компиляция — минимальный размер CSS
- Хорошо документирован

**Установка:**
```bash
npm install tailwindcss
npx tailwindcss init
```

### 12.3. Alpine.js

**Описание:** Минималистичный JS-фреймворк (~17KB), добавляющий реактивность прямо в HTML.

**Основные директивы:**
- `x-data` — объявление реактивных данных
- `x-show` — условное отображение
- `x-on` / `@click` — обработка событий
- `x-bind` / `:class` — привязка атрибутов
- `x-text` — вывод текста
- `x-for` — циклы

**Пример использования:**
```html
<div x-data="{ open: false }">
    <button @click="open = !open">Меню</button>
    <nav x-show="open">...</nav>
</div>
```

**Преимущества:**
- Не требует сборки
- Идеально подходит для Django templates
- Заменяет jQuery для простых задач

### 12.4. django-cotton — Компонентный подход

**Описание:** Библиотека для создания переиспользуемых компонентов в Django templates с HTML-подобным синтаксисом. Работает как React/Vue компоненты, но для Django.

**GitHub:** https://github.com/wrabit/django-cotton

**Установка:**
```bash
pip install django-cotton
```

**Ключевые возможности:**
- HTML-подобный синтаксис: `<c-button>`, `<c-card>`
- Слоты для контента (default и named)
- Передача props и атрибутов
- Автодополнение в IDE
- Полная совместимость с Django templates

**Пример компонента:**
```html
<!-- templates/cotton/card.html -->
<div class="bg-white shadow rounded p-4">
    <h2>{{ title }}</h2>
    <p>{{ slot }}</p>
    <a href="{{ url }}">Подробнее</a>
</div>
```

**Использование:**
```html
<c-card title="Новость" url="/news/1">
    Текст новости...
</c-card>
```

**Передача атрибутов:**
```html
<!-- templates/cotton/input.html -->
<input type="text" class="border rounded px-3 py-2" {{ attrs }} />

<!-- Использование -->
<c-input placeholder="Введите имя" name="name" required />
```

### 12.5. shadcn-django — Библиотека UI-компонентов

**Описание:** Неофициальный порт shadcn/ui для Django. Компоненты копируются в проект через CLI — полный контроль над кодом.

**GitHub:** https://github.com/SarthakJariwala/shadcn-django

**Стек:** Tailwind CSS + Alpine.js + django-cotton

**Установка:**
```bash
# Инициализация проекта
uvx shadcn_django init

# Просмотр доступных компонентов
uvx shadcn_django list

# Добавление компонентов
uvx shadcn_django add button
uvx shadcn_django add card
uvx shadcn_django add modal
```

**Зависимости (npm):**
```bash
npm install -D tailwindcss tw-animate-css
```

**Использование компонентов:**
```html
<c-button variant="default">Отправить</c-button>
<c-button variant="outline">Отмена</c-button>
<c-button variant="destructive">Удалить</c-button>
```

**Компоненты для проекта АИР ТО:**

| Компонент | Где используется |
|-----------|-----------------|
| **button** | Кнопки форм, CTA |
| **card** | Карточки организаций, проектов, новостей |
| **accordion** | FAQ, раскрывающиеся блоки |
| **tabs** | Вкладки в разделах |
| **modal/dialog** | Модальные окна |
| **toast** | Уведомления после отправки форм |
| **input, textarea, select** | Формы обратной связи |
| **badge** | Статусы проектов |
| **tooltip** | Подсказки |

**Преимущества:**
- Знакомый workflow для тех, кто работал с shadcn/ui
- Полный контроль над кодом компонентов
- Единый стиль с экосистемой shadcn
- HTMX-совместимость

### 12.6. Структура frontend-файлов

```
src/
├── static/
│   ├── css/
│   │   ├── input.css      # Исходный Tailwind
│   │   └── output.css     # Скомпилированный CSS
│   └── js/
│       └── alpine.min.js  # Alpine.js (CDN или локально)
├── templates/
│   ├── base.html          # Базовый шаблон
│   └── cotton/            # shadcn-django компоненты
│       ├── button.html
│       ├── card.html
│       ├── modal.html
│       ├── input.html
│       └── ...
```

### 12.7. Подключение в base.html

```html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}АИР ТО{% endblock %}</title>

    <!-- Tailwind CSS -->
    <link href="{% static 'css/output.css' %}" rel="stylesheet">

    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body>
    {% block content %}{% endblock %}
</body>
</html>
```

### 12.8. Unfold Admin — Современная тема Django Admin

**Описание:** Полная замена стандартного интерфейса Django Admin на современный UI. Построен на том же стеке: Tailwind CSS + Alpine.js + HTMX.

**Сайт:** https://unfoldadmin.com/

**Ключевые возможности:**
- Кастомные дашборды с виджетами, графиками, статистикой
- Настраиваемое боковое меню с иконками и группировкой
- Command Palette — быстрый поиск и навигация (Cmd/Ctrl + K)
- Темизация — готовые цветовые схемы или кастомные
- Условные поля — динамическое отображение полей в формах
- Расширенные фильтры — date picker, числовые диапазоны
- Пагинация inline-записей — для больших наборов данных
- Библиотека компонентов — для кастомных страниц

**Установка:**
```bash
pip install django-unfold
```

**Конфигурация settings.py:**
```python
INSTALLED_APPS = [
    "unfold",  # ПЕРЕД django.contrib.admin
    "unfold.contrib.filters",  # расширенные фильтры
    "unfold.contrib.forms",  # улучшенные формы
    "unfold.contrib.inlines",  # пагинация inlines
    "unfold.contrib.import_export",  # если используется django-import-export
    "django.contrib.admin",
    # ...
]

UNFOLD = {
    "SITE_TITLE": "АИР ТО — Админ-панель",
    "SITE_HEADER": "Агентство инвестиционного развития",
    "DASHBOARD_CALLBACK": "apps.core.views.dashboard_callback",
}
```

**Использование в admin.py:**
```python
from django.contrib import admin
from unfold.admin import ModelAdmin

@admin.register(News)
class NewsAdmin(ModelAdmin):
    list_display = ["title", "date", "is_published"]
    list_filter = ["is_published", "date"]
```

**Преимущества для проекта АИР ТО:**
- Единый визуальный стиль с публичной частью (Tailwind)
- Удобный интерфейс для контент-менеджеров
- Дашборд со статистикой (кол-во новостей, заявок, проектов)
- Не требует написания кастомного CSS для админки

---

## 13. Ограничения по локализации данных

### 13.1. Обоснование

Для государственных и муниципальных сайтов Российской Федерации действуют требования по локализации данных (152-ФЗ, требования ФСТЭК). Использование зарубежных сервисов, передающих данные за пределы РФ, создаёт правовые и репутационные риски.

### 13.2. Ограничения

| Категория | Нельзя использовать | Допустимые альтернативы |
|-----------|---------------------|------------------------|
| **Картографические сервисы** | Google Maps, Leaflet с OSM-тайлами, Mapbox | Яндекс.Карты, 2ГИС, OrbisMap |
| **Аналитика** | Google Analytics | Яндекс.Метрика |
| **Шрифты** | Google Fonts (CDN) | Локальное размещение шрифтов |
| **CDN** | Cloudflare, jsDelivr | Локальные файлы или российские CDN |
| **Капча** | Google reCAPTCHA | Яндекс SmartCaptcha, собственное решение |

### 13.3. Используемые сервисы в проекте

| Сервис | Назначение | Статус |
|--------|------------|--------|
| **Яндекс.Карты** | Карта проезда (страница контактов) | Включён в базовый проект |
| **Яндекс.Метрика** | Статистика посещений | Включён в базовый проект |
| **Email (SMTP)** | Отправка заявок | Включён в базовый проект |
| **OrbisMap** | Инвестиционная карта (опция) | Отдельная опция (см. time-estimate.md) |

### 13.4. Важно

- Все статические ресурсы (JS, CSS, шрифты) размещаются локально на сервере
- Хостинг — только на территории РФ (Selectel, Timeweb, REG.RU и др.)
- SSL-сертификат — от российского или международного УЦ (Let's Encrypt допустим)

---

*Документ подготовлен на основе брифа из файла `brif-site.md`*
